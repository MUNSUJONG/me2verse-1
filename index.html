<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Me2Verse ì™„ì „ì²´ ì²´í—˜</title>
<style>
body { font-family: Arial; margin:0; padding:0; background:#eaeaea; display:flex; flex-direction:column; align-items:center; }
h1 { color:#c0392b; margin:10px 0; text-align:center; }
#levelContainer { width:90%; background:#ccc; border-radius:10px; margin:10px auto; height:25px; overflow:hidden; }
#levelBar { height:25px; width:0%; background:#f39c12; text-align:center; color:#fff; line-height:25px; transition:width 0.5s; font-weight:bold; }
#moduleButtons { display:flex; flex-wrap:wrap; justify-content:center; margin-top:10px; }
.button { margin:6px; padding:12px 20px; font-size:16px; color:#fff; background:#2980b9; border:none; border-radius:8px; cursor:pointer; flex:1; min-width:120px; transition:0.2s; }
.button:hover { background:#2471a3; }
.module { display:none; padding:20px; margin:20px auto; border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,0.2); max-width:700px; width:90%; position:relative; background:#fff; }
.moduleOverlay { background: rgba(255,255,255,0.8); padding: 10px; border-radius: 10px; }
.chat-box { border:1px solid #ccc; padding:10px; height:300px; overflow-y:auto; border-radius:10px; background:#fefefe; margin-bottom:10px; }
.message { margin:6px 0; padding:8px 12px; border-radius:12px; max-width:80%; clear:both; word-break:break-word; }
.message.ai { background:#2980b9; color:#fff; float:left; }
.message.user { background:#27ae60; color:#fff; float:right; }
#userInput { width:calc(100% - 100px); padding:10px; border-radius:8px; border:1px solid #ccc; font-size:16px; }
#sendBtn { padding:10px 16px; border:none; border-radius:8px; background:#e67e22; color:#fff; cursor:pointer; transition:0.2s; }
#sendBtn:hover { background:#d35400; }
.backBtn { background:#16a085; margin-top:10px; }
.backBtn:hover { background:#0e6655; }
</style>
</head>
<body>

<h1>ğŸš€ Me2Verse ì™„ì „ì²´ ì²´í—˜</h1>

<div id="levelContainer">
  <div id="levelBar">ë ˆë²¨ 1 (0 XP)</div>
</div>

<div id="moduleButtons">
  <button class="button" onclick="showModule('love')">â¤ï¸ ì—°ì• </button>
  <button class="button" onclick="showModule('marriage')">ğŸ’ ê²°í˜¼</button>
  <button class="button" onclick="showModule('hobby')">ğŸ¨ ì·¨ë¯¸</button>
  <button class="button" onclick="showModule('space')">ğŸŒŒ ìš°ì£¼</button>
  <button class="button" onclick="showModule('culture')">ğŸ›ï¸ ë¬¸í™”ì²´í—˜</button>
  <button class="button" onclick="showModule('language')">ğŸ—£ï¸ ì–¸ì–´ì²´í—˜</button>
</div>

<div id="moduleContainer"></div>

<script>
// ---------- XP/ë ˆë²¨ ----------
let level = 1, xp = 0, currentModule='', currentNode='';
const xpPerLevel = 20;

function updateLevelBar(){
  let percent = ((xp % xpPerLevel)/xpPerLevel)*100;
  document.getElementById('levelBar').style.width = percent + '%';
  document.getElementById('levelBar').textContent = `ë ˆë²¨ ${level} (${xp} XP)`;
}

function addXP(amount){
  xp += amount;
  while(xp >= level*xpPerLevel){
    level++;
    alert(`ğŸ‰ ë ˆë²¨ì—…! ë ˆë²¨ ${level} ë‹¬ì„±!`);
  }
  updateLevelBar();
}

// ---------- ëª¨ë“ˆ ë°ì´í„° ----------
const modulesData = {
  love:{aiName:"ì—°ì¸ AI", background:"https://picsum.photos/id/1015/700/300",
    storyTree:{
      start:{ text:"ë°ì´íŠ¸ ì¥ì†Œ ì„ íƒ:", options:{ ì¹´í˜:{text:"â˜• ì¹´í˜ ë°ì´íŠ¸ ì‹œì‘!", next:"conversation", xp:5}, ê³µì›:{text:"ğŸŒ³ ê³µì› ì‚°ì±… ì‹œì‘!", next:"conversation", xp:5} } },
      conversation:{ text:"ëŒ€í™” ì£¼ì œ ì„ íƒ:", options:{ ì˜í™”:{text:"ğŸ¬ ì˜í™” ì´ì•¼ê¸°!", next:"end", xp:5}, ìŒì•…:{text:"ğŸµ ìŒì•… ì´ì•¼ê¸°!", next:"end", xp:5} } },
      end:{ text:"ë°ì´íŠ¸ ì¦ê±°ì› ìŠµë‹ˆë‹¤! ğŸ‰", xp:10 }
    }
  },
  marriage:{aiName:"ì›¨ë”© í”Œë˜ë„ˆ AI", background:"https://picsum.photos/id/1016/700/300",
    storyTree:{
      start:{ text:"ì‹ì¥ ìŠ¤íƒ€ì¼ ì„ íƒ:", options:{ ì „í†µì‹:{text:"ğŸ¯ ì „í†µì‹ ì¤€ë¹„ ì™„ë£Œ!", next:"dress", xp:10}, í˜„ëŒ€ì‹:{text:"ğŸ° í˜„ëŒ€ì‹ ì¤€ë¹„ ì™„ë£Œ!", next:"dress", xp:10} } },
      dress:{ text:"ë“œë ˆìŠ¤ ì„ íƒ:", options:{ í™”ì´íŠ¸:{text:"ğŸ‘° í™”ì´íŠ¸ ë“œë ˆìŠ¤ ì„ íƒ!", next:"end", xp:5}, í•‘í¬:{text:"ğŸŒ¸ í•‘í¬ ë“œë ˆìŠ¤ ì„ íƒ!", next:"end", xp:5} } },
      end:{ text:"ê²°í˜¼ì‹ ì¤€ë¹„ ì™„ë£Œ! ğŸ‰", xp:10 }
    }
  },
  hobby:{aiName:"ì·¨ë¯¸ ë©˜í†  AI", background:"https://picsum.photos/id/1025/700/300",
    storyTree:{
      start:{ text:"ì·¨ë¯¸ ì„ íƒ:", options:{ ê·¸ë¦¼:{text:"ğŸ–Œï¸ ê·¸ë¦¼ ì‹œì‘!", next:"practice", xp:3}, ì•…ê¸°:{text:"ğŸ¹ ì•…ê¸° ì‹œì‘!", next:"practice", xp:3} } },
      practice:{ text:"ì—°ìŠµ ì™„ë£Œ?", options:{ yes:{text:"ğŸ‘ ì—°ìŠµ ì™„ë£Œ!", next:"end", xp:5}, no:{text:"ğŸ’ª ë” ì—°ìŠµ í•„ìš”!", next:"practice", xp:2} } },
      end:{ text:"ì·¨ë¯¸ ì²´í—˜ ì™„ë£Œ! ğŸ‰", xp:5 }
    }
  },
  space:{aiName:"ìš°ì£¼ì„  AI", background:"https://picsum.photos/id/1020/700/300",
    storyTree:{
      start:{ text:"íƒì‚¬ ëª©í‘œ ì„ íƒ:", options:{ ë‹¬:{text:"ğŸŒ• ë‹¬ íƒì‚¬ ì‹œì‘!", next:"mission", xp:8}, í™”ì„±:{text:"ğŸª í™”ì„± íƒì‚¬ ì‹œì‘!", next:"mission", xp:8} } },
      mission:{ text:"ì¥ë¹„ ì ê²€:", options:{ ì ê²€ì™„ë£Œ:{text:"âœ… ì ê²€ ì™„ë£Œ!", next:"end", xp:5}, ì ê²€ë¯¸ì™„ë£Œ:{text:"âš ï¸ ì ê²€ í•„ìš”!", next:"mission", xp:2} } },
      end:{ text:"ë¯¸ì…˜ ì™„ë£Œ! ğŸš€", xp:10 }
    }
  },
  culture:{aiName:"ë¬¸í™” ê°€ì´ë“œ AI", background:"https://picsum.photos/id/1035/700/300",
    storyTree:{
      start:{ text:"ì²´í—˜í•  ë¬¸í™” ì„ íƒ:", options:{ ë¯¸ìˆ ê´€:{text:"ğŸ–¼ï¸ ë¯¸ìˆ ê´€ ì²´í—˜!", next:"tour", xp:5}, ë°•ë¬¼ê´€:{text:"ğŸº ë°•ë¬¼ê´€ ì²´í—˜!", next:"tour", xp:5} } },
      tour:{ text:"ì „ì‹œ ì„¤ëª… ë“£ê¸°", options:{ ì„¤ëª…ë“£ê¸°:{text:"ğŸ¤ ì„¤ëª… ì™„ë£Œ!", next:"end", xp:5} } },
      end:{ text:"ë¬¸í™”ì²´í—˜ ì™„ë£Œ! ğŸ‰", xp:10 }
    }
  },
  language:{aiName:"ì–¸ì–´ íŠœí„° AI", background:"https://picsum.photos/id/1045/700/300",
    storyTree:{
      start:{ text:"ë°°ìš¸ ì–¸ì–´ ì„ íƒ:", options:{ ì˜ì–´:{text:"ğŸ‡ºğŸ‡¸ ì˜ì–´ í•™ìŠµ ì‹œì‘!", next:"practice", xp:5}, ì¼ë³¸ì–´:{text:"ğŸ‡¯ğŸ‡µ ì¼ë³¸ì–´ í•™ìŠµ ì‹œì‘!", next:"practice", xp:5} } },
      practice:{ text:"ê°„ë‹¨í•œ ë¬¸ì¥ ì…ë ¥:", options:{ ì˜ˆ:{text:"ğŸ¯ ë¬¸ì¥ í•™ìŠµ ì„±ê³µ!", next:"end", xp:5} } },
      end:{ text:"ì–¸ì–´ì²´í—˜ ì™„ë£Œ! ğŸ‰", xp:10 }
    }
  }
};

// ---------- SPA í•¨ìˆ˜ ----------
function showModule(id){ 
  currentModule=id; 
  currentNode='start'; 
  renderModule(); 
}

function backToMain(){ 
  currentModule=''; 
  document.getElementById('moduleContainer').innerHTML=''; 
}

function addMessage(sender,text){
  const chatBox=document.getElementById('chatBox');
  if(!chatBox) return;
  const div=document.createElement('div');
  div.className='message '+sender;
  div.textContent=text;
  chatBox.appendChild(div);
  chatBox.scrollTop=chatBox.scrollHeight;
}

// ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬
function handleUserInput(){
  const inputBox=document.getElementById('userInput');
  if(!inputBox || !inputBox.value) return;
  const userText = inputBox.value;
  addMessage('user', userText);
  inputBox.value='';
  processNode(userText);
}

// ì…ë ¥ ë¶„ì„
function processNode(userText){
  const node=modulesData[currentModule].storyTree[currentNode];
  if(!node.options) return;
  const keywords = Object.keys(node.options);
  let chosen = keywords.find(k=>userText.includes(k));
  if(!chosen) chosen = keywords[Math.floor(Math.random()*keywords.length)];
  chooseOption(chosen);
}

// ì„ íƒì§€ ì²˜ë¦¬
function chooseOption(opt){
  const node = modulesData[currentModule].storyTree[currentNode];
  if(!node.options) return;
  const sel=node.options[opt];
  if(!sel) return;
  addMessage('ai', sel.text);
  addXP(sel.xp||0);
  currentNode=sel.next;
  setTimeout(renderModule,300);
}

// ë Œë”ë§
function renderModule(){
  const data = modulesData[currentModule];
  if(!data) return;
  const node = data.storyTree[currentNode];
  const container=document.getElementById('moduleContainer');
  container.innerHTML=`<div class="module" style="background-image:url(${data.background}); background-size:cover; background-position:center;">
    <div class="moduleOverlay">
      <div class="chat-box" id="chatBox"></div>
      <input type="text" id="userInput" placeholder="ì—¬ê¸°ì— ì…ë ¥í•˜ê³  Enter" onkeypress="if(event.key==='Enter'){handleUserInput();}">
      <button id="sendBtn" onclick="handleUserInput()">ë³´ë‚´ê¸°</button>
      <button class="backBtn" onclick="backToMain()">â¬…ï¸ ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
    </div>
  </div>`;

  // AI ì´ˆê¸° ë©”ì‹œì§€ ì¶œë ¥
  if(node.text){
    addMessage('ai', node.text);
  }

  // ì„ íƒì§€ ë²„íŠ¼ ë Œë”ë§
  if(node.options){
    const optionDiv = document.createElement('div');
    optionDiv.style.marginTop = '10px';
    for(let key in node.options){
      const btn = document.createElement('button');
      btn.textContent = node.options[key].text;
      btn.className = 'button';
      btn.style.margin='4px';
      btn.onclick = () => chooseOption(key);
      optionDiv.appendChild(btn);
    }
    container.querySelector('.moduleOverlay').appendChild(optionDiv);
  }
}

// ì´ˆê¸° ë ˆë²¨ë°” ì—…ë°ì´íŠ¸
updateLevelBar();
</script>

</body>
</html>
