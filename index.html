<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Me2Verse - Demo</title>
  <style>
    body { margin:0; overflow:hidden; }
    canvas { display:block; }
  </style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/three@0.160/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.160/examples/js/controls/OrbitControls.js"></script>
<script>
// ê¸°ë³¸ ì„¸íŒ…
let scene = new THREE.Scene();
scene.background = new THREE.Color(0xeeeeee);

let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0, 1.6, 3);

let renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

let controls = new THREE.OrbitControls(camera, renderer.domElement);

let raycaster = new THREE.Raycaster();
let mouse = new THREE.Vector2();

// ë°”ë‹¥
let floorGeo = new THREE.PlaneGeometry(20,20);
let floorMat = new THREE.MeshBasicMaterial({color:0xcccccc});
let floor = new THREE.Mesh(floorGeo, floorMat);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

// ë²„íŠ¼ ë§Œë“¤ê¸°
function createButton(name, color, x, z, labelText) {
  const group = new THREE.Group();

  // ë²„íŠ¼ ë°•ìŠ¤
  const geometry = new THREE.BoxGeometry(0.8, 0.3, 0.2);
  const material = new THREE.MeshBasicMaterial({color});
  const mesh = new THREE.Mesh(geometry, material);
  mesh.position.set(x, 1, z);
  mesh.name = name;
  group.add(mesh);

  // ë¼ë²¨
  const canvas = document.createElement("canvas");
  const ctx = canvas.getContext("2d");
  canvas.width = 256;
  canvas.height = 64;
  ctx.fillStyle = "#000000";
  ctx.font = "bold 32px Arial";
  ctx.textAlign = "center";
  ctx.fillText(labelText, 128, 40);

  const texture = new THREE.CanvasTexture(canvas);
  const labelMat = new THREE.MeshBasicMaterial({map: texture, transparent:true});
  const labelGeo = new THREE.PlaneGeometry(1,0.25);
  const label = new THREE.Mesh(labelGeo, labelMat);
  label.position.set(x, 1.3, z);
  group.add(label);

  scene.add(group);
  return mesh;
}

// ë²„íŠ¼ ìƒì„±
createButton("Teleport", 0x00ff00, -1.5, -2, "Teleport");
createButton("Kiosk", 0xff0000, 1.5, -2, "Kiosk");

// í´ë¦­ ì²˜ë¦¬
function pick(clientX, clientY) {
  mouse.x = (clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(clientY / window.innerHeight) * 2 + 1;

  raycaster.setFromCamera(mouse, camera);
  return raycaster.intersectObjects(scene.children, true)[0];
}

addEventListener("click", (e) => {
  const hit = pick(e.clientX, e.clientY);
  if (hit) {
    let obj = hit.object;
    if (obj.name === "Teleport") {
      camera.position.set(0, 1.6, -5);
      console.log("Teleport activated!");
    }
    if (obj.name === "Kiosk") {
      alert("ðŸ“¢ Kiosk: ì´ë²¤íŠ¸ ì•ˆë‚´, ì²´í—˜ ì •ë³´ í‘œì‹œ!");
      console.log("Kiosk opened!");
    }
  }
});

// ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
function animate() {
  requestAnimationFrame(animate);
  controls.update();
  renderer.render(scene, camera);
}
animate();

// ë¦¬ì‚¬ì´ì¦ˆ ëŒ€ì‘
window.addEventListener('resize', ()=>{
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
