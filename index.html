<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Me2Verse VR ë©”íƒ€ë²„ìŠ¤ ì™„ì„±í˜•</title>
<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
<style>
  body { margin:0; padding:0; font-family: Arial, sans-serif; background:#f0f0f0; }
  #status{position:fixed;top:10px;left:50%;transform:translateX(-50%);
          background:rgba(255,255,255,0.85);padding:5px 10px;border-radius:5px;font-size:16px; z-index:5;}
  #score{position:fixed;bottom:10px;left:50%;transform:translateX(-50%);
         background:rgba(0,0,0,0.6);color:white;padding:5px 10px;border-radius:5px;font-size:16px; z-index:5;}
  .screen{width:100%;height:100vh;display:flex;justify-content:center;
          align-items:center;flex-direction:column;transition:all 0.5s;position:absolute;top:0;left:0;}
  #homeScreen{background:white; z-index:3;}
  #moduleScreen{background:#fafafa;display:none; z-index:2;overflow-y:auto;}
  #vrScreen{background:black;display:none; z-index:1;}
  input,select,button{padding:10px 15px;margin:5px;font-size:16px;border-radius:5px;border:1px solid #ccc;}
  button{cursor:pointer;border:none;color:white;}
  #autoBtn{background-color:#2196F3;}
  .moduleBtn{background-color:#4CAF50;}
  .storyBtn{background-color:#FF9800;width:90%;margin:5px;}
  #startVRBtn{background-color:#9C27B0;display:none;margin-top:10px;}
  #backBtn{background-color:#FF5722;display:none;margin-top:15px;}
  #questLog{margin-top:15px;background:rgba(255,255,255,0.8);padding:10px;border-radius:5px;width:90%;max-width:500px;font-size:14px;max-height:150px;overflow-y:auto;}
  a-scene{width:100%;height:100vh;}
</style>
</head>
<body>

<div id="status">ìƒíƒœ: ëŒ€ê¸° ì¤‘</div>
<div id="score">í¬ì¸íŠ¸: 0 | ì•„ì´í…œ: ì—†ìŒ</div>

<!-- í™ˆ í™”ë©´ -->
<div id="homeScreen" class="screen">
  <h1>ğŸš€ Me2Verse VR ë©”íƒ€ë²„ìŠ¤</h1>
  <p>Piê³„ì • ë¡œê·¸ì¸ í›„ ë¬´ë£Œ ì²´í—˜ ë˜ëŠ” í•˜ì´ë¼ì´íŠ¸ ì²´í—˜ ì„ íƒ</p>
  <input type="text" id="username" placeholder="Pi ê³„ì • ì…ë ¥">
  <button id="autoBtn">ë¡œê·¸ì¸</button>
</div>

<!-- ëª¨ë“ˆ ì„ íƒ í™”ë©´ -->
<div id="moduleScreen" class="screen">
  <h2>ëª¨ë“ˆ ì„ íƒ</h2>
  <div id="moduleList"></div>
  <button id="backBtn">ğŸ  í™ˆìœ¼ë¡œ</button>
  <div id="moduleDetail">
    <h3 id="moduleTitle"></h3>
    <p id="moduleDesc"></p>
    <div id="storyList"></div>
    <button id="startVRBtn">VR ì²´í—˜ ì‹œì‘</button>
    <div id="questLog"></div>
  </div>
</div>

<!-- VR í™”ë©´ -->
<div id="vrScreen" class="screen">
  <a-scene id="vrScene">
    <a-sky id="vrSky" color="#ECECEC"></a-sky>
    <a-entity id="moduleContent"></a-entity>
    <a-entity id="cameraRig" position="0 1.6 0">
      <a-camera wasd-controls look-controls>
        <a-cursor color="black"></a-cursor>
      </a-camera>
    </a-entity>
    <a-entity light="type: ambient; intensity:0.6"></a-entity>
    <a-entity light="type: directional; intensity:0.8" position="1 2 1"></a-entity>
  </a-scene>
  <button id="vrBackBtn" style="position:fixed;top:10px;left:10px;z-index:10;padding:10px;background:#FF5722;color:white;border:none;border-radius:5px;">ë’¤ë¡œê°€ê¸°</button>
</div>

<script>
// ê¸°ë³¸ ìƒíƒœ
const statusEl=document.getElementById("status");
const scoreEl=document.getElementById("score");
const homeScreen=document.getElementById("homeScreen");
const moduleScreen=document.getElementById("moduleScreen");
const vrScreen=document.getElementById("vrScreen");
const moduleList=document.getElementById("moduleList");
const moduleTitle=document.getElementById("moduleTitle");
const moduleDesc=document.getElementById("moduleDesc");
const storyList=document.getElementById("storyList");
const startVRBtn=document.getElementById("startVRBtn");
const backBtn=document.getElementById("backBtn");
const questLog=document.getElementById("questLog");
const moduleContent=document.getElementById("moduleContent");
const vrSky=document.getElementById("vrSky");
const vrBackBtn=document.getElementById("vrBackBtn");

let points=0, items=[], currentModule="", currentStory="", logMessages=[];

function updateScore(){ scoreEl.textContent=`í¬ì¸íŠ¸: ${points} | ì•„ì´í…œ: ${items.length?items.join(", "):"ì—†ìŒ"}`; }
function logQuest(msg){ logMessages.push(msg); questLog.innerHTML=logMessages.map(m=>`â€¢ ${m}`).join("<br>"); }

// ë¡œê·¸ì¸
document.getElementById("autoBtn").addEventListener("click",()=>{
  const username=document.getElementById("username").value.trim();
  if(!username){ alert("Piê³„ì • ì…ë ¥ í•„ìš”!"); return; }
  statusEl.textContent=`ìƒíƒœ: ${username} ë¡œê·¸ì¸ ì„±ê³µ! ğŸ‰`;
  homeScreen.style.display="none";
  moduleScreen.style.display="flex";
  renderModules();
});

// ëª¨ë“ˆ + ìŠ¤í† ë¦¬ ì •ì˜
const modules={
  love:{title:"ì—°ì•  ëª¨ë“ˆ", desc:"ì—°ì•  ì²´í—˜ ìŠ¤í† ë¦¬", sky:"#FFC0CB",
    stories:[...Array(10)].map((_,i)=>({title:`ì—°ì•  ìŠ¤í† ë¦¬ ${i+1}`, desc:`ì—°ì•  ì´ì•¼ê¸° ${i+1} ìƒì„¸ ë‚´ìš©`, points:10, item:"í•˜íŠ¸", free:true}))},
  space:{title:"ìš°ì£¼ì²´í—˜ ëª¨ë“ˆ", desc:"ìš°ì£¼ íƒí—˜ ìŠ¤í† ë¦¬", sky:"#000022",
    stories:[...Array(10)].map((_,i)=>({title:`ìš°ì£¼ ìŠ¤í† ë¦¬ ${i+1}`, desc:`í–‰ì„± íƒí—˜ ${i+1} ìƒì„¸ ë‚´ìš©`, points:15, item:"ì§€ë„", free:false}))},
  hobby:{title:"ì·¨ë¯¸ ëª¨ë“ˆ", desc:"ì·¨ë¯¸ ì²´í—˜ ìŠ¤í† ë¦¬", sky:"#A0E0A0",
    stories:[...Array(10)].map((_,i)=>({title:`ì·¨ë¯¸ ìŠ¤í† ë¦¬ ${i+1}`, desc:`ìˆ²ì† ì²´í—˜ ${i+1} ìƒì„¸ ë‚´ìš©`, points:5, item:"ê½ƒ", free:true}))},
  idol:{title:"ì•„ì´ëŒ ëª¨ë“ˆ", desc:"ì•„ì´ëŒ ì²´í—˜ ìŠ¤í† ë¦¬", sky:"#FFD700",
    stories:[...Array(10)].map((_,i)=>({title:`ì•„ì´ëŒ ìŠ¤í† ë¦¬ ${i+1}`, desc:`íŒ¬ ì²´í—˜ ${i+1} ìƒì„¸ ë‚´ìš©`, points:20, item:"íŒ¬ì¹´ë“œ", free:false}))},
  wedding:{title:"ê°€ìƒê²°í˜¼ ëª¨ë“ˆ", desc:"ê²°í˜¼ ì²´í—˜ ìŠ¤í† ë¦¬", sky:"#FFB6C1",
    stories:[...Array(10)].map((_,i)=>({title:`ê²°í˜¼ ìŠ¤í† ë¦¬ ${i+1}`, desc:`ê²°í˜¼ ì´ë²¤íŠ¸ ${i+1} ìƒì„¸ ë‚´ìš©`, points:25, item:"ë°˜ì§€", free:false}))}
};

// ëª¨ë“ˆ ë¦¬ìŠ¤íŠ¸ ë Œë”
function renderModules(){
  moduleList.innerHTML="";
  for(const key in modules){
    const btn=document.createElement("button");
    btn.className="moduleBtn";
    btn.textContent=modules[key].title;
    btn.addEventListener("click",()=>selectModule(key));
    moduleList.appendChild(btn);
  }
}

// ëª¨ë“ˆ ì„ íƒ
function selectModule(name){
  currentModule=name;
  const mod=modules[name];
  moduleTitle.textContent=mod.title;
  moduleDesc.textContent=mod.desc;
  storyList.innerHTML="";
  startVRBtn.style.display="none";
  backBtn.style.display="inline-block";
  mod.stories.forEach((story,i)=>{
    const btn=document.createElement("button");
    btn.className="storyBtn";
    btn.textContent=`${story.title} ${story.free?"[ë¬´ë£Œ]":"[ìœ ë£Œ]"}`;
    btn.addEventListener("click",()=>selectStory(i));
    storyList.appendChild(btn);
  });
}

// ìŠ¤í† ë¦¬ ì„ íƒ
function selectStory(idx){
  const story=modules[currentModule].stories[idx];
  currentStory=story;
  startVRBtn.style.display="inline-block";
  logQuest(`ì„ íƒí•œ ìŠ¤í† ë¦¬: ${story.title} (${story.free?"ë¬´ë£Œ":"ìœ ë£Œ"})`);
}

// VR ì²´í—˜
startVRBtn.addEventListener("click",()=>{
  if(!currentStory) return;
  moduleScreen.style.display="none";
  vrScreen.style.display="flex";
  points=0; items=[]; updateScore();
  logMessages=[];
  vrSky.setAttribute("color",modules[currentModule].sky);
  moduleContent.innerHTML="";

  const avatar=document.createElement("a-box");
  avatar.setAttribute("position","0 1 -3");
  avatar.setAttribute("color","#FF69B4");
  avatar.setAttribute("depth","1"); avatar.setAttribute("height","2"); avatar.setAttribute("width","1");
  avatar.addEventListener("click",()=>{
    points+=currentStory.points;
    items.push(currentStory.item);
    updateScore();
    logQuest(`${currentStory.desc} ì™„ë£Œ! +${currentStory.points}ì , ${currentStory.item} íšë“`);
  });
  moduleContent.appendChild(avatar);
});

// ë’¤ë¡œê°€ê¸°
backBtn.addEventListener("click",()=>{
  if(vrScreen.style.display==="flex"){
    vrScreen.style.display="none";
    moduleScreen.style.display="flex";
  }else{
    moduleScreen.style.display="none";
    homeScreen.style.display="flex";
  }
  startVRBtn.style.display="none";
  moduleContent.innerHTML="";
  logMessages=[];
  questLog.innerHTML="";
});

vrBackBtn.addEventListener("click",()=>{
  vrScreen.style.display="none";
  moduleScreen.style.display="flex";
  startVRBtn.style.display="none";
  moduleContent.innerHTML="";
  logMessages=[];
  questLog.innerHTML="";
});

</script>
</body>
</html>
