<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Me2Verse VR ì™„ì „íŒ</title>
<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
<style>
  body{margin:0;font-family:Arial,sans-serif;background:#f0f0f0;}
  .screen{width:100%;height:100vh;display:flex;justify-content:center;align-items:center;flex-direction:column;position:absolute;top:0;left:0;transition:0.5s;}
  #homeScreen{background:white;z-index:3;}
  #moduleScreen{background:#fafafa;display:none;z-index:2;}
  #vrScreen{background:black;display:none;z-index:1;}
  input,select,button{padding:10px 15px;margin:5px;font-size:16px;border-radius:5px;border:1px solid #ccc;}
  button{cursor:pointer;border:none;color:white;}
  #autoBtn{background:#2196F3;}
  .moduleBtn{background:#4CAF50;}
  #startVRBtn{background:#9C27B0;display:none;margin-top:10px;}
  #backBtn{background:#FF5722;display:none;margin-top:15px;}
  #status{position:fixed;top:10px;left:50%;transform:translateX(-50%);background:rgba(255,255,255,0.85);padding:5px 10px;border-radius:5px;z-index:3;font-size:16px;}
  #score{position:fixed;bottom:10px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.6);color:white;padding:5px 10px;border-radius:5px;font-size:16px;z-index:3;}
  #questLog{margin-top:15px;background:rgba(255,255,255,0.8);padding:10px;border-radius:5px;width:80%;max-width:400px;font-size:14px;max-height:150px;overflow-y:auto;}
  a-scene{width:100%;height:100vh;}
  #flag{width:80px;margin-bottom:10px;}
  #piBalance{font-weight:bold;margin-top:5px;}
</style>
</head>
<body>
<div id="status">ìƒíƒœ: ëŒ€ê¸° ì¤‘</div>
<div id="score">í¬ì¸íŠ¸: 0 | ì•„ì´í…œ: ì—†ìŒ | Piì½”ì¸: 0</div>

<!-- í™ˆ í™”ë©´ -->
<div id="homeScreen" class="screen">
  <img id="flag" src="https://upload.wikimedia.org/wikipedia/commons/0/09/Flag_of_South_Korea.svg" alt="íƒœê·¹ê¸°">
  <h1>ğŸš€ Me2Verse VR ì™„ì „íŒ</h1>
  <p>ë¡œê·¸ì¸ â†’ Piì½”ì¸ ê²°ì œ â†’ ëª¨ë“ˆ ì„ íƒ â†’ VR ì²´í—˜ â†’ ë’¤ë¡œê°€ê¸°</p>
  <input type="text" id="username" placeholder="ìœ ì € ì´ë¦„ ì…ë ¥">
  <div id="piBalance">Piì½”ì¸ ì”ì•¡: 100</div>
  <select id="amount">
    <option value="10">10 Piì½”ì¸</option>
    <option value="50">50 Piì½”ì¸</option>
    <option value="100">100 Piì½”ì¸</option>
  </select>
  <br/>
  <button id="autoBtn">ìë™ ë¡œê·¸ì¸ + ê²°ì œ</button>
</div>

<!-- ëª¨ë“ˆ ì„ íƒ / ìƒì„¸ í™”ë©´ -->
<div id="moduleScreen" class="screen">
  <h2>ëª¨ë“ˆ ì„ íƒ</h2>
  <div>
    <button class="moduleBtn" id="loveModule">ì—°ì•  ëª¨ë“ˆ</button>
    <button class="moduleBtn" id="spaceModule">ìš°ì£¼ì²´í—˜ ëª¨ë“ˆ</button>
    <button class="moduleBtn" id="hobbyModule">ì·¨ë¯¸ ëª¨ë“ˆ</button>
  </div>
  <div id="moduleDetail" style="margin-top:20px;">
    <h3 id="moduleTitle"></h3>
    <p id="moduleDesc"></p>
    <button id="startVRBtn">VR ì²´í—˜ ì‹œì‘</button>
    <button id="backBtn">ğŸ  ë’¤ë¡œê°€ê¸°</button>
    <div id="questLog"></div>
  </div>
</div>

<!-- VR í™”ë©´ -->
<div id="vrScreen" class="screen">
  <a-scene id="vrScene">
    <a-sky id="vrSky" color="#ECECEC"></a-sky>
    <a-entity id="moduleContent"></a-entity>
    <a-entity id="cameraRig" position="0 1.6 0">
      <a-camera wasd-controls look-controls>
        <a-cursor color="black"></a-cursor>
      </a-camera>
    </a-entity>
  </a-scene>
</div>

<script>
alert("âœ… Me2Verse VR ì™„ì „íŒ ì‹¤í–‰!");

const statusEl=document.getElementById("status");
const scoreEl=document.getElementById("score");
const homeScreen=document.getElementById("homeScreen");
const moduleScreen=document.getElementById("moduleScreen");
const vrScreen=document.getElementById("vrScreen");
const moduleContent=document.getElementById("moduleContent");
const vrSky=document.getElementById("vrSky");
const moduleTitle=document.getElementById("moduleTitle");
const moduleDesc=document.getElementById("moduleDesc");
const startVRBtn=document.getElementById("startVRBtn");
const backBtn=document.getElementById("backBtn");
const questLog=document.getElementById("questLog");
const piBalanceEl=document.getElementById("piBalance");
const amountSelect=document.getElementById("amount");

let points=0, items=[], currentModule="", logMessages=[], piBalance=100;

function updateScore(){scoreEl.textContent=`í¬ì¸íŠ¸: ${points} | ì•„ì´í…œ: ${items.length?items.join(", "):"ì—†ìŒ"} | Piì½”ì¸: ${piBalance}`;}
function logQuest(msg){logMessages.push(msg); questLog.innerHTML=logMessages.map(m=>`â€¢ ${m}`).join("<br>");}

// ìë™ ë¡œê·¸ì¸ + Piì½”ì¸ ê²°ì œ
document.getElementById("autoBtn").addEventListener("click", ()=>{
  const username=document.getElementById("username").value.trim();
  const amount=parseInt(amountSelect.value);
  if(!username){ alert("ìœ ì € ì´ë¦„ ì…ë ¥ í•„ìš”!"); return; }
  if(amount>piBalance){ alert("ì”ì•¡ ë¶€ì¡±!"); return; }

  statusEl.textContent=`ìƒíƒœ: ${username} ë¡œê·¸ì¸ ì¤‘...`;
  setTimeout(()=>{
    statusEl.textContent=`ìƒíƒœ: ${username} ë¡œê·¸ì¸ ì„±ê³µ! ğŸ‰`;
    statusEl.textContent=`ìƒíƒœ: ${amount} Piì½”ì¸ ê²°ì œ ì²˜ë¦¬ ì¤‘...`;
    setTimeout(()=>{
      piBalance-=amount; piBalanceEl.textContent=`Piì½”ì¸ ì”ì•¡: ${piBalance}`;
      statusEl.textContent=`ìƒíƒœ: ${username} ê²°ì œ ì™„ë£Œ! ğŸ’°`;
      alert(`${username}ë‹˜ì˜ ${amount} Piì½”ì¸ ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`);
      homeScreen.style.display="none"; moduleScreen.style.display="flex"; updateScore();
    },1500);
  },1000);
});

// ëª¨ë“ˆ ì •ì˜ (ìŠ¤í† ë¦¬ + í™˜ê²½ + ì•„ë°”íƒ€ + ì˜¤ë¸Œì íŠ¸)
const modules={
  love:{
    title:"ì—°ì•  ëª¨ë“ˆ",
    desc:"ê³µì›ì—ì„œ ìºë¦­í„°ì™€ ìƒí˜¸ì‘ìš©í•˜ë©° ì—°ì•  ì²´í—˜! í•˜íŠ¸ì™€ Piì½”ì¸ì„ ëª¨ìœ¼ì„¸ìš”.",
    sky:"#FFC0CB",
    avatars:[
      {type:"box", pos:"-1 1 -3", color:"#FF69B4", log:"ğŸ’Œ ìºë¦­í„°1 ëŒ€í™” ì™„ë£Œ! +10ì , í•˜íŠ¸ íšë“, Piì½”ì¸+5", points:10, item:"í•˜íŠ¸", pi:5, anim:true},
      {type:"box", pos:"1 1 -3", color:"#FF1493", log:"ğŸ’Œ ìºë¦­í„°2 ëŒ€í™” ì™„ë£Œ! +10ì , í•˜íŠ¸ íšë“, Piì½”ì¸+5", points:10, item:"í•˜íŠ¸", pi:5, anim:true}
    ],
    props:[
      {type:"cone", pos:"0 0 -4", color:"#FFB6C1", height:1, radius:0.5, log:"ğŸŒ¸ ê½ƒ ê´€ì°° ì™„ë£Œ! +5ì , ê½ƒ íšë“, Piì½”ì¸+2", points:5, item:"ê½ƒ", pi:2, anim:true},
      {type:"sphere", pos:"0 2 -5", color:"#FFD700", radius:0.3, log:"ğŸ ë³´ë„ˆìŠ¤ ì„ ë¬¼ ë°œê²¬! +20ì , ì´ˆì½” íšë“, Piì½”ì¸+10", points:20, item:"ì´ˆì½”", pi:10, anim:true}
    ]
  },
  space:{
    title:"ìš°ì£¼ì²´í—˜ ëª¨ë“ˆ",
    desc:"íƒì‚¬ì„  íƒ‘ìŠ¹ â†’ í–‰ì„± íƒí—˜ â†’ ì§€ë„ì™€ Piì½”ì¸ íšë“!",
    sky:"#000022",
    avatars:[
      {type:"sphere", pos:"-1 1.5 -4", color:"#FFA500", log:"ğŸª í–‰ì„±1 íƒí—˜ ì™„ë£Œ! +15ì , ì§€ë„ íšë“, Piì½”ì¸+7", points:15, item:"í–‰ì„± ì§€ë„", pi:7, anim:true},
      {type:"sphere", pos:"1 2 -5", color:"#00FFFF", log:"ğŸª í–‰ì„±2 íƒí—˜ ì™„ë£Œ! +15ì , ì§€ë„ íšë“, Piì½”ì¸+7", points:15, item:"í–‰ì„± ì§€ë„", pi:7, anim:true}
    ],
    props:[
      {type:"box", pos:"0 1 -6", color:"#8A2BE2", depth:0.5, height:0.5, width:0.5, log:"ğŸ ë³´ë„ˆìŠ¤ ì¥ë¹„ ë°œê²¬! +25ì , ì¥ë¹„ íšë“, Piì½”ì¸+12", points:25, item:"ìš°ì£¼ ì¥ë¹„", pi:12, anim:true}
    ]
  },
  hobby:{
    title:"ì·¨ë¯¸ ëª¨ë“ˆ",
    desc:"ìˆ²ì† ì‚°ì±…ê³¼ ì·¨ë¯¸ í™œë™ì„ VRë¡œ ì²´í—˜! ê½ƒ, ì»¤í”¼, ì—´ë§¤, Piì½”ì¸ì„ ìˆ˜ì§‘í•˜ì„¸ìš”.",
    sky:"#A0E0A0",
    avatars:[
      {type:"cone", pos:"-1 0.5 -3", color:"#228B22", height:2, radius:0.5, log:"ğŸŒ³ ê½ƒ ê´€ì°° ì™„ë£Œ! +5ì , ê½ƒ íšë“, Piì½”ì¸+2", points:5, item:"ê½ƒ", pi:2, anim:true},
      {type:"box", pos:"1 0.3 -3", color:"#8B4513", depth:0.5, height:0.5, width:2, log:"ğŸª‘ ë²¤ì¹˜ì—ì„œ íœ´ì‹ ì™„ë£Œ! +5ì , ì»¤í”¼ íšë“, Piì½”ì¸+2", points:5, item:"ì»¤í”¼", pi:2, anim:true}
    ],
    props:[
      {type:"sphere", pos:"0 1.5 -4", color:"#FF4500", radius:0.3, log:"ğŸ ë³´ë„ˆìŠ¤ ì—´ë§¤ ë°œê²¬! +15ì , ì—´ë§¤ íšë“, Piì½”ì¸+5", points:15, item:"ì—´ë§¤", pi:5, anim:true}
    ]
  }
};

function selectModule(name){
  currentModule=name;
  moduleTitle.textContent=modules[name].title;
  moduleDesc.textContent=modules[name].desc;
  startVRBtn.style.display="inline-block";
  backBtn.style.display="inline-block";
  logMessages=[]; questLog.innerHTML="";
}

document.getElementById("loveModule").addEventListener("click", ()=>selectModule("love"));
document.getElementById("spaceModule").addEventListener("click", ()=>selectModule("space"));
document.getElementById("hobbyModule").addEventListener("click", ()=>selectModule("hobby"));

startVRBtn.addEventListener("click", ()=>{
  moduleScreen.style.display="none"; vrScreen.style.display="flex";
  moduleContent.innerHTML=""; points=0; items=[]; updateScore();
  logMessages=[]; questLog.innerHTML="";

  const mod=modules[currentModule];
  vrSky.setAttribute("color",mod.sky);

  mod.avatars.concat(mod.props).forEach(obj=>{
    const el=document.createElement(`a-${obj.type}`);
    el.setAttribute("position",obj.pos);
    el.setAttribute("color",obj.color);
    if(obj.type==="box"){ el.setAttribute("depth",obj.depth||1); el.setAttribute("height",obj.height||2); el.setAttribute("width",obj.width||1); }
    if(obj.type==="cone"){ el.setAttribute("height",obj.height); el.setAttribute("radius-bottom",obj.radius); }
    if(obj.type==="sphere"){ el.setAttribute("radius",obj.radius||1); }
    if(obj.anim){ el.setAttribute("animation__hover","property=rotation; to=0 360 0; loop=true; dur=4000; easing=linear"); }

    el.addEventListener("click", ()=>{
      points+=obj.points; items.push(obj.item); piBalance+=obj.pi;
      updateScore(); logQuest(obj.log);
      el.setAttribute("animation__click","property=rotation; to=0 720 0; dur=1000; easing=linear");
    });
    moduleContent.appendChild(el);
  });
});

backBtn.addEventListener("click", ()=>{
  if(vrScreen.style.display==="flex"){ vrScreen.style.display="none"; moduleScreen.style.display="flex"; }
  else{ moduleScreen.style.display="none"; homeScreen.style.display="flex"; }
  backBtn.style.display="none"; startVRBtn.style.display="none";
  moduleContent.innerHTML="
