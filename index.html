<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Me2Verse VR ì™„ì„±í˜•</title>
<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
<style>
  body { margin:0; padding:0; font-family: Arial, sans-serif; background:#f0f0f0; }
  .screen { width:100%; height:100vh; display:flex; justify-content:center; align-items:center; flex-direction:column; position:absolute; top:0; left:0; transition:0.5s; }
  #homeScreen { background:white; z-index:3; }
  #moduleScreen { background:#fafafa; z-index:2; display:none; }
  #vrScreen { background:black; z-index:1; display:none; }
  input, select, button { padding:10px 15px; margin:5px; font-size:16px; border-radius:5px; border:1px solid #ccc; }
  button { cursor:pointer; border:none; color:white; }
  #autoBtn { background:#2196F3; }
  .moduleBtn { background:#4CAF50; }
  #startVRBtn { background:#9C27B0; display:none; margin-top:10px; }
  #backBtn { background:#FF5722; display:none; margin-top:10px; }
  #status { position:fixed; top:10px; left:50%; transform:translateX(-50%); background:rgba(255,255,255,0.85); padding:5px 10px; border-radius:5px; z-index:5; }
  #score { position:fixed; bottom:10px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.6); color:white; padding:5px 10px; border-radius:5px; z-index:5; }
  #questLog { margin-top:15px; background:rgba(255,255,255,0.8); padding:10px; border-radius:5px; width:80%; max-width:400px; font-size:14px; max-height:150px; overflow-y:auto; }
</style>
</head>
<body>

<div id="status">ìƒíƒœ: ëŒ€ê¸° ì¤‘</div>
<div id="score">í¬ì¸íŠ¸: 0 | ì•„ì´í…œ: ì—†ìŒ</div>

<!-- í™ˆ í™”ë©´ -->
<div id="homeScreen" class="screen">
  <h1>ğŸš€ Me2Verse VR</h1>
  <p>Pië„¤íŠ¸ì›Œí¬ ê³„ì • ë¡œê·¸ì¸ í›„ ë¬´ë£Œì²´í—˜ ë˜ëŠ” í•˜ì´ë¼ì´íŠ¸ ì²´í—˜ ê°€ëŠ¥</p>
  <input type="text" id="username" placeholder="ìœ ì € ì´ë¦„ ì…ë ¥">
  <button id="autoBtn">ë¡œê·¸ì¸ / ë¬´ë£Œì²´í—˜</button>
</div>

<!-- ëª¨ë“ˆ ì„ íƒ í™”ë©´ -->
<div id="moduleScreen" class="screen">
  <h2>ëª¨ë“ˆ ì„ íƒ</h2>
  <div>
    <button class="moduleBtn" id="loveModule">ì—°ì•  ëª¨ë“ˆ</button>
    <button class="moduleBtn" id="spaceModule">ìš°ì£¼ì²´í—˜ ëª¨ë“ˆ</button>
    <button class="moduleBtn" id="hobbyModule">ì·¨ë¯¸ ëª¨ë“ˆ</button>
  </div>
  <div id="moduleDetail" style="margin-top:20px;">
    <h3 id="moduleTitle"></h3>
    <p id="moduleDesc"></p>
    <select id="storySelect"></select>
    <button id="startVRBtn">VR ì²´í—˜ ì‹œì‘</button>
    <button id="backBtn">ğŸ  ë’¤ë¡œê°€ê¸°</button>
    <div id="questLog"></div>
  </div>
</div>

<!-- VR í™”ë©´ -->
<div id="vrScreen" class="screen">
  <a-scene id="vrScene">
    <a-sky id="vrSky" color="#ECECEC"></a-sky>
    <a-entity id="moduleContent"></a-entity>
    <a-entity id="cameraRig" position="0 1.6 0">
      <a-camera wasd-controls look-controls>
        <a-cursor color="black"></a-cursor>
      </a-camera>
    </a-entity>
    <a-entity light="type: ambient; intensity:0.6"></a-entity>
    <a-entity light="type: directional; intensity:0.8" position="1 2 1"></a-entity>
  </a-scene>
  <button id="backFromVR" style="position:absolute;top:10px;right:10px;padding:10px;background:#FF5722;color:white;border:none;border-radius:5px;z-index:5;">ğŸ  ë’¤ë¡œê°€ê¸°</button>
</div>

<script>
const statusEl = document.getElementById("status");
const scoreEl = document.getElementById("score");
const homeScreen = document.getElementById("homeScreen");
const moduleScreen = document.getElementById("moduleScreen");
const vrScreen = document.getElementById("vrScreen");
const moduleTitle = document.getElementById("moduleTitle");
const moduleDesc = document.getElementById("moduleDesc");
const storySelect = document.getElementById("storySelect");
const startVRBtn = document.getElementById("startVRBtn");
const backBtn = document.getElementById("backBtn");
const questLog = document.getElementById("questLog");
const moduleContent = document.getElementById("moduleContent");
const vrSky = document.getElementById("vrSky");
const backFromVR = document.getElementById("backFromVR");

let points=0, items=[], currentModule="", currentStory=0, logMessages=[], userName="";

// ìƒ˜í”Œ ìŠ¤í† ë¦¬ ë°ì´í„° (ê° ëª¨ë“ˆ 10ê°œ ì´ìƒ)
const modules = {
  love: Array.from({length:10},(_,i)=>({title:`ì—°ì•  ìŠ¤í† ë¦¬ ${i+1}`, desc:`ì—°ì•  ëª¨í—˜ ì²´í—˜ ${i+1}`, points:5+i, item:`í•˜íŠ¸${i+1}`})),
  space: Array.from({length:10},(_,i)=>({title:`ìš°ì£¼ ìŠ¤í† ë¦¬ ${i+1}`, desc:`ìš°ì£¼ íƒí—˜ ì²´í—˜ ${i+1}`, points:10+i, item:`ì§€ë„${i+1}`})),
  hobby: Array.from({length:10},(_,i)=>({title:`ì·¨ë¯¸ ìŠ¤í† ë¦¬ ${i+1}`, desc:`ì·¨ë¯¸ ì²´í—˜ ${i+1}`, points:3+i, item:`ê½ƒ${i+1}`})),
};

function updateScore(){ scoreEl.textContent=`í¬ì¸íŠ¸: ${points} | ì•„ì´í…œ: ${items.length?items.join(", "):"ì—†ìŒ"}`; }
function logQuest(msg){ logMessages.push(msg); questLog.innerHTML=logMessages.map(m=>`â€¢ ${m}`).join("<br>"); }

// ë¡œê·¸ì¸ + ë¬´ë£Œì²´í—˜
document.getElementById("autoBtn").addEventListener("click",()=>{
  userName = document.getElementById("username").value.trim();
  if(!userName){ alert("ìœ ì € ì´ë¦„ ì…ë ¥ í•„ìš”!"); return; }
  statusEl.textContent=`${userName} ë¡œê·¸ì¸ ì„±ê³µ! ë¬´ë£Œì²´í—˜ ê°€ëŠ¥ ğŸ‰`;
  homeScreen.style.display="none";
  moduleScreen.style.display="flex";
});

// ëª¨ë“ˆ ì„ íƒ
function selectModule(name){
  currentModule = name;
  moduleTitle.textContent = `${name} ëª¨ë“ˆ`;
  moduleDesc.textContent = "ìŠ¤í† ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”.";
  storySelect.innerHTML = "";
  modules[name].forEach((story,i)=>{
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = story.title;
    storySelect.appendChild(opt);
  });
  startVRBtn.style.display="inline-block";
  backBtn.style.display="inline-block";
  logMessages=[];
  questLog.innerHTML="";
}

document.getElementById("loveModule").addEventListener("click",()=>selectModule("love"));
document.getElementById("spaceModule").addEventListener("click",()=>selectModule("space"));
document.getElementById("hobbyModule").addEventListener("click",()=>selectModule("hobby"));

// VR ì‹œì‘
startVRBtn.addEventListener("click",()=>{
  currentStory = parseInt(storySelect.value);
  const story = modules[currentModule][currentStory];
  moduleScreen.style.display="none";
  vrScreen.style.display="flex";
  moduleContent.innerHTML="";
  points = 0; items = []; updateScore();
  logMessages=[];
  questLog.innerHTML="";
  vrSky.setAttribute("color","#ECECEC");

  // ë‹¨ìˆœ ìƒí˜¸ì‘ìš© ì˜ˆì‹œ
  const entity = document.createElement("a-box");
  entity.setAttribute("position","0 1 -3");
  entity.setAttribute("color","#FF69B4");
  entity.setAttribute("depth","1"); entity.setAttribute("height","2"); entity.setAttribute("width","1");
  entity.addEventListener("click",()=>{
    points += story.points;
    items.push(story.item);
    updateScore();
    logQuest(`ğŸ’Œ ${story.item} íšë“! +${story.points}ì `);
  });
  moduleContent.appendChild(entity);
});

// ë’¤ë¡œê°€ê¸°
backBtn.addEventListener("click",()=>{
  moduleScreen.style.display="none";
  homeScreen.style.display="flex";
  backBtn.style.display="none";
  startVRBtn.style.display="none";
});

backFromVR.addEventListener("click",()=>{
  vrScreen.style.display="none";
  moduleScreen.style.display="flex";
});

</script>
</body>
</html>
