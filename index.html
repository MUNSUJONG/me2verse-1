<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Me2Verse VR 통합형 체험</title>
<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
<style>
  body { margin:0; padding:0; font-family: Arial, sans-serif; background:#f0f0f0; }
  #status{position:fixed;top:10px;left:50%;transform:translateX(-50%);
          background:rgba(255,255,255,0.85);padding:5px 10px;border-radius:5px;font-size:16px; z-index:5;}
  #score{position:fixed;bottom:10px;left:50%;transform:translateX(-50%);
         background:rgba(0,0,0,0.6);color:white;padding:5px 10px;border-radius:5px;font-size:16px; z-index:5;}
  .screen{width:100%;height:100vh;display:flex;justify-content:center;
          align-items:center;flex-direction:column;transition:all 0.5s;position:absolute;top:0;left:0;}
  #homeScreen{background:white; z-index:3;}
  #moduleScreen{background:#fafafa;display:none; z-index:2;}
  #vrScreen{background:black;display:none; z-index:1;}
  input,select,button{padding:10px 15px;margin:5px;font-size:16px;border-radius:5px;border:1px solid #ccc;}
  button{cursor:pointer;border:none;color:white;}
  #autoBtn{background-color:#2196F3;}
  .moduleBtn{background-color:#4CAF50;}
  #startVRBtn{background-color:#9C27B0;display:none;margin-top:10px;}
  #backBtn{background-color:#FF5722;display:none;margin-top:15px;}
  #questLog{margin-top:15px;background:rgba(255,255,255,0.8);padding:10px;border-radius:5px;width:80%;max-width:400px;font-size:14px;max-height:150px;overflow-y:auto;}
  a-scene{width:100%;height:100vh;}
  #flagContainer{display:flex; justify-content:space-between; width:100%; max-width:400px; margin-bottom:10px;}
  #flagContainer img{width:80px;}
</style>
</head>
<body>

<div id="status">상태: 대기 중</div>
<div id="score">포인트: 0 | 아이템: 없음</div>

<!-- 홈 화면 -->
<div id="homeScreen" class="screen">
  <div id="flagContainer">
    <img src="https://upload.wikimedia.org/wikipedia/commons/0/09/Flag_of_South_Korea.svg" alt="태극기">
    <img src="https://upload.wikimedia.org/wikipedia/commons/0/09/Flag_of_South_Korea.svg" alt="태극기">
  </div>
  <h1>🚀 Me2Verse VR 통합 체험</h1>
  <p>로그인(파이 네트워크 계정) 후 무료 체험 또는 하이라이트 체험 선택</p>
  <input type="text" id="username" placeholder="유저 이름 입력">
  <button id="autoBtn">로그인</button>
</div>

<!-- 모듈 선택 화면 -->
<div id="moduleScreen" class="screen">
  <h2>모듈 선택</h2>
  <div>
    <button class="moduleBtn" id="loveModule">연애 모듈</button>
    <button class="moduleBtn" id="spaceModule">우주체험 모듈</button>
    <button class="moduleBtn" id="hobbyModule">취미 모듈</button>
    <button class="moduleBtn" id="travelModule">여행 모듈</button>
  </div>
  <div id="moduleDetail" style="margin-top:20px;">
    <h3 id="moduleTitle"></h3>
    <p id="moduleDesc"></p>
    <button id="startVRBtn">VR 체험 시작</button>
    <button id="backBtn">🏠 홈으로</button>
    <div id="questLog"></div>
  </div>
</div>

<!-- VR 화면 -->
<div id="vrScreen" class="screen">
  <a-scene id="vrScene">
    <a-sky id="vrSky" color="#ECECEC"></a-sky>
    <a-entity id="moduleContent"></a-entity>
    <a-entity id="cameraRig" position="0 1.6 0">
      <a-camera wasd-controls look-controls>
        <a-cursor color="black"></a-cursor>
      </a-camera>
    </a-entity>
    <a-entity light="type: ambient; intensity:0.6"></a-entity>
    <a-entity light="type: directional; intensity:0.8" position="1 2 1"></a-entity>
  </a-scene>
</div>

<script>
const statusEl=document.getElementById("status");
const scoreEl=document.getElementById("score");
const homeScreen=document.getElementById("homeScreen");
const moduleScreen=document.getElementById("moduleScreen");
const vrScreen=document.getElementById("vrScreen");
const moduleContent=document.getElementById("moduleContent");
const vrSky=document.getElementById("vrSky");
const moduleTitle=document.getElementById("moduleTitle");
const moduleDesc=document.getElementById("moduleDesc");
const startVRBtn=document.getElementById("startVRBtn");
const backBtn=document.getElementById("backBtn");
const questLog=document.getElementById("questLog");

let points=0, items=[], currentModule="", logMessages=[];

function updateScore(){ scoreEl.textContent=`포인트: ${points} | 아이템: ${items.length?items.join(", "):"없음"}`; }
function logQuest(msg){ logMessages.push(msg); questLog.innerHTML=logMessages.map(m=>`• ${m}`).join("<br>"); }

// 로그인
document.getElementById("autoBtn").addEventListener("click",()=>{
  const username=document.getElementById("username").value.trim();
  if(!username){ alert("유저 이름 입력 필요!"); return; }
  statusEl.textContent=`상태: ${username} 로그인 중...`;
  setTimeout(()=>{
    statusEl.textContent=`상태: ${username} 로그인 성공! 🎉`;
    alert(`${username}님 환영합니다!`);
    homeScreen.style.display="none";
    moduleScreen.style.display="flex";
  },1000);
});

// 모듈 정의 (각 모듈 10개 이상 스토리)
const modules={
love:{title:"연애 모듈", desc:"공원과 카페 등에서 캐릭터와 상호작용하며 감성 체험", sky:"#FFC0CB",
stories:[
{desc:"첫 만남", points:5, item:"하트"},
{desc:"첫 대화", points:5, item:"하트"},
{desc:"공원 산책", points:10, item:"사진"},
{desc:"커피 데이트", points:10, item:"커피"},
{desc:"축제 참가", points:15, item:"축제 표"},
{desc:"영화관 데이트", points:15, item:"팝콘"},
{desc:"밤하늘 관찰", points:20, item:"별"},
{desc:"편지 주기", points:20, item:"편지"},
{desc:"선물 주기", points:25, item:"선물"},
{desc:"연애 완료", points:50, item:"하트 뱃지"}]
},
space:{title:"우주체험 모듈", desc:"탐사선 탑승 → 행성 탐험 → 지도, 아이템 수집", sky:"#000022",
stories:[
{desc:"탐사선 탑승", points:5, item:"탑승권"},
{desc:"행성 착륙", points:10, item:"행성 지도"},
{desc:"화성 탐사", points:15, item:"화성 샘플"},
{desc:"금성 탐사", points:15, item:"금성 샘플"},
{desc:"소행성 관찰", points:20, item:"소행성 샘플"},
{desc:"은하 탐험", points:25, item:"은하 지도"},
{desc:"우주 정거장 체험", points:25, item:"정거장 기념품"},
{desc:"블랙홀 관찰", points:30, item:"블랙홀 기록"},
{desc:"외계인 접촉", points:40, item:"외계 생명체 기록"},
{desc:"우주 체험 완료", points:50, item:"우주 뱃지"}]
},
hobby:{title:"취미 모듈", desc:"숲속 산책, 미술, 음악 등 체험", sky:"#A0E0A0",
stories:[
{desc:"숲속 산책", points:5, item:"꽃"},
{desc:"꽃 관찰", points:5, item:"꽃 사진"},
{desc:"새 소리 듣기", points:10, item:"새 소리 기록"},
{desc:"미술 체험", points:15, item:"그림"},
{desc:"음악 감상", points:15, item:"악보"},
{desc:"사진 촬영", points:20, item:"사진"},
{desc:"커피 만들기", points:20, item:"커피"},
{desc:"차 마시기", points:25, item:"찻잔"},
{desc:"캠핑 체험", points:25, item:"텐트"},
{desc:"취미 완료", points:50, item:"취미 뱃지"}]
},
travel:{title:"여행 모듈", desc:"세계 각지 여행과 명소 탐험", sky:"#87CEEB",
stories:[
{desc:"서울 탐방", points:5, item:"서울 사진"},
{desc:"부산 탐방", points:5, item:"부산 사진"},
{desc:"제주 여행", points:10, item:"제주 사진"},
{desc:"경주 탐방", points:10, item:"경주 사진"},
{desc:"세계 박물관 방문", points:15, item:"박물관 기념품"},
{desc:"유적지 탐험", points:20, item:"유적 기념품"},
{desc:"현지 음식 체험", points:25, item:"음식 사진"},
{desc:"전통 공연 관람", points:25, item:"공연 표"},
{desc:"도시 야경 관람", points:30, item:"야경 사진"},
{desc:"여행 완료", points:50, item:"여행 뱃지"}]
}
};

function selectModule(name){
currentModule=name;
moduleTitle.textContent=modules[name].title;
moduleDesc.textContent=modules[name].desc;
startVRBtn.style.display="inline-block";
backBtn.style.display="inline-block";
logMessages=[];
questLog.innerHTML="";
}

document.getElementById("loveModule").addEventListener("click",()=>selectModule("love"));
document.getElementById("spaceModule").addEventListener("click",()=>selectModule("space"));
document.getElementById("hobbyModule").addEventListener("click",()=>selectModule("hobby"));
document.getElementById("travelModule").addEventListener("click",()=>selectModule("travel"));

// VR 체험 시작
startVRBtn.addEventListener("click",()=>{
moduleScreen.style.display="none";
vrScreen.style.display="flex";
moduleContent.innerHTML="";
points=0; items=[]; updateScore();
logMessages=[]; questLog.innerHTML="";

const mod=modules[currentModule];
vrSky.setAttribute("color",mod.sky);

// 아바타/스토리 순차적 체험
mod.stories.forEach((story,index)=>{
setTimeout(()=>{
points+=story.points; 
items.push(story.item); 
updateScore(); 
logQuest(story.desc + " 완료! +" + story.points + "점, " + story.item + " 획득");
}, index*2000); // 2초 간격으로 진행
});
});

// 뒤로가기
backBtn.addEventListener("click",()=>{
if(vrScreen.style.display==="flex"){
vrScreen.style.display="none";
moduleScreen.style.display="flex";
}else{
moduleScreen.style.display="none";
homeScreen.style.display="flex";
}
backBtn.style.display="none";
startVRBtn.style.display="none";
moduleContent.innerHTML="";
logMessages=[];
questLog.innerHTML="";
statusEl.textContent="상태: 대기 중";
});
</script>
</body>
</html>
