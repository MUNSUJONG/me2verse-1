<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Me2Verse AI 대화형 체험</title>
<style>
body { font-family: Arial; margin:0; padding:0; background:#f0f4f8; display:flex; flex-direction:column; align-items:center; }
h1 { color:#e74c3c; margin:10px 0; text-align:center; }
#levelContainer { width:90%; background:#ddd; border-radius:10px; margin:10px auto; height:25px; overflow:hidden; }
#levelBar { height:25px; width:0%; background:#f39c12; text-align:center; color:#fff; line-height:25px; transition:width 0.5s; font-weight:bold; }
#moduleButtons { display:flex; flex-wrap:wrap; justify-content:center; margin-top:10px; }
.button { margin:6px; padding:12px 20px; font-size:16px; color:#fff; background:#3498db; border:none; border-radius:8px; cursor:pointer; flex:1; min-width:120px; transition:0.2s; }
.button:hover { background:#2980b9; }
.module { display:none; padding:20px; margin:20px auto; border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,0.2); max-width:600px; width:90%; position:relative; background:#fff; }
.chat-box { border:1px solid #ccc; padding:10px; height:300px; overflow-y:auto; border-radius:10px; background:#fefefe; margin-bottom:10px; }
.message { margin:6px 0; padding:8px 12px; border-radius:12px; max-width:80%; clear:both; }
.message.ai { background:#3498db; color:#fff; float:left; }
.message.user { background:#2ecc71; color:#fff; float:right; }
#userInput { width:calc(100% - 100px); padding:10px; border-radius:8px; border:1px solid #ccc; font-size:16px; }
#sendBtn { padding:10px 16px; border:none; border-radius:8px; background:#e67e22; color:#fff; cursor:pointer; transition:0.2s; }
#sendBtn:hover { background:#d35400; }
.backBtn { background:#16a085; margin-top:10px; }
.backBtn:hover { background:#0e6655; }
</style>
</head>
<body>

<h1>🚀 Me2Verse AI 대화형 체험</h1>
<div id="levelContainer">
  <div id="levelBar">레벨 1 (0 XP)</div>
</div>

<div id="moduleButtons">
  <button class="button" onclick="showModule('love')">❤️ 연애</button>
  <button class="button" onclick="showModule('marriage')">💍 결혼</button>
  <button class="button" onclick="showModule('hobby')">🎨 취미</button>
  <button class="button" onclick="showModule('space')">🌌 우주</button>
</div>

<!-- 모듈 구조 -->
<div id="love" class="module">
  <h2>❤️ 연애 체험</h2>
  <div class="chat-box" id="loveChat"></div>
  <input type="text" id="loveInput" placeholder="AI에게 말해보세요...">
  <button id="loveSend" class="button" onclick="sendMessage('love')">보내기</button>
  <button class="button backBtn" onclick="backToMain()">메인으로</button>
</div>

<div id="marriage" class="module">
  <h2>💍 결혼 체험</h2>
  <div class="chat-box" id="marriageChat"></div>
  <input type="text" id="marriageInput" placeholder="AI에게 말해보세요...">
  <button id="marriageSend" class="button" onclick="sendMessage('marriage')">보내기</button>
  <button class="button backBtn" onclick="backToMain()">메인으로</button>
</div>

<div id="hobby" class="module">
  <h2>🎨 취미 체험</h2>
  <div class="chat-box" id="hobbyChat"></div>
  <input type="text" id="hobbyInput" placeholder="AI에게 말해보세요...">
  <button id="hobbySend" class="button" onclick="sendMessage('hobby')">보내기</button>
  <button class="button backBtn" onclick="backToMain()">메인으로</button>
</div>

<div id="space" class="module">
  <h2>🌌 우주 체험</h2>
  <div class="chat-box" id="spaceChat"></div>
  <input type="text" id="spaceInput" placeholder="AI에게 말해보세요...">
  <button id="spaceSend" class="button" onclick="sendMessage('space')">보내기</button>
  <button class="button backBtn" onclick="backToMain()">메인으로</button>
</div>

<script>
// 레벨/XP
let level = 1;
let xp = 0;
const xpPerLevel = 20;

function updateLevelBar(){
  let percent = (xp % xpPerLevel)/xpPerLevel*100;
  document.getElementById('levelBar').style.width = percent + '%';
  document.getElementById('levelBar').textContent = `레벨 ${level} (${xp} XP)`;
}

function addXP(amount){
  xp += amount;
  if(xp >= level*xpPerLevel){
    level++;
    alert(`🎉 레벨업! 레벨 ${level} 달성!`);
  }
  updateLevelBar();
}

// 모듈 관리
let currentModule = '';
function showModule(id){
  currentModule = id;
  const modules = document.querySelectorAll('.module');
  modules.forEach(m=>m.style.display='none');
  document.getElementById(id).style.display='block';
  startConversation(id);
}

function backToMain(){
  const modules = document.querySelectorAll('.module');
  modules.forEach(m=>m.style.display='none');
  currentModule = '';
}

// AI 대화 초기화
const aiModules = {
  love:{chatId:'loveChat', inputId:'loveInput', messages:[], aiName:'연인 AI'},
  marriage:{chatId:'marriageChat', inputId:'marriageInput', messages:[], aiName:'웨딩 플래너 AI'},
  hobby:{chatId:'hobbyChat', inputId:'hobbyInput', messages:[], aiName:'취미 멘토 AI'},
  space:{chatId:'spaceChat', inputId:'spaceInput', messages:[], aiName:'우주선 AI'}
};

// 대화 시작
function startConversation(module){
  const ai = aiModules[module];
  ai.messages = [];
  addAIMessage(module, `안녕하세요! ${ai.aiName}입니다. 대화를 시작해볼까요?`);
}

// 메시지 표시
function addMessage(module, text, sender){
  const ai = aiModules[module];
  const chatBox = document.getElementById(ai.chatId);
  const msgDiv = document.createElement('div');
  msgDiv.className = 'message '+sender;
  msgDiv.textContent = text;
  chatBox.appendChild(msgDiv);
  chatBox.scrollTop = chatBox.scrollHeight;
}

// AI 메시지
function addAIMessage(module, text){
  addMessage(module,text,'ai');
  aiModules[module].messages.push({sender:'ai', text});
  addXP(2); // AI 메시지마다 XP
}

// 사용자 메시지
function sendMessage(module){
  const ai = aiModules[module];
  const input = document.getElementById(ai.inputId);
  if(!input.value) return;
  addMessage(module,input.value,'user');
  ai.messages.push({sender:'user', text:input.value});
  // AI 반응 생성
  setTimeout(()=>generateAIResponse(module,input.value),500);
  input.value='';
}

// 간단 AI 응답 (랜덤 또는 선택 기반)
function generateAIResponse(module, userText){
  const ai = aiModules[module];
  const responses = [
    "정말 흥미로운 선택이네요!",
    "그런 방법도 있군요!",
    "좋아요, 계속 진행해봐요!",
    "음… 다른 방법도 시도해볼까요?"
  ];
  const response = responses[Math.floor(Math.random()*responses.length)];
  addAIMessage(module,response);
}
</script>
</body>
</html>
