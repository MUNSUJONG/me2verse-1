window.addEventListener('load', () => {
  const isSandbox = window.location.hostname === 'sandbox.minepi.com';

  Pi.init({ version: "2.0", sandbox: isSandbox });

  const status = document.getElementById('status');
  const loginBtn = document.getElementById('loginBtn');

  status.innerText = `✅ SDK 초기화 완료 (${isSandbox ? '샌드박스' : '프로덕션'})`;

  setTimeout(() => {
    loginBtn.disabled = false;

    loginBtn.addEventListener('click', async () => {
      status.innerText = '로그인 시도 중...';
      try {
        const auth = await Pi.authenticate(['username']);
        status.innerText = `로그인 성공: ${auth.user.username}`;
      } catch (e) {
        status.innerText = `로그인 실패: ${e.message}`;
        console.error(e);
      }
    });
  }, 300);
});
